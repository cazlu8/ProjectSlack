{"version":3,"sources":["lru-cache.js"],"names":[],"mappings":";;AAAA,CAAC,CAAC,YAAY;;;AAEd,MAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,OAAO,EAAE;AAChD,UAAM,CAAC,OAAO,GAAG,QAAQ,CAAA;GAC1B,MAAM;;AAEL,QAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;GACzB;;AAED,WAAS,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE;AACtB,WAAO,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAA;GACtD;;AAED,WAAS,WAAW,GAAI;AAAE,WAAO,CAAC,CAAA;GAAE;;AAEpC,WAAS,QAAQ,CAAE,OAAO,EAAE;AAC1B,QAAI,EAAE,IAAI,YAAY,QAAQ,CAAA,AAAC,EAC7B,OAAO,IAAI,QAAQ,CAAC,OAAO,CAAC,CAAA;;AAE9B,QAAI,OAAO,OAAO,KAAK,QAAQ,EAC7B,OAAO,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,CAAA;;AAE5B,QAAI,CAAC,OAAO,EACV,OAAO,GAAG,EAAE,CAAA;;AAEd,QAAI,CAAC,IAAI,GAAG,OAAO,CAAC,GAAG,CAAA;;AAEvB,QAAI,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE,OAAO,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAA,AAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,EAClE,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAA;;AAEtB,QAAI,CAAC,iBAAiB,GAAG,OAAO,CAAC,MAAM,IAAI,WAAW,CAAA;AACtD,QAAI,OAAO,IAAI,CAAC,iBAAiB,KAAK,UAAU,EAC9C,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAA;;AAEtC,QAAI,CAAC,WAAW,GAAG,OAAO,CAAC,KAAK,IAAI,KAAK,CAAA;AACzC,QAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,IAAI,IAAI,CAAA;AACrC,QAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAA;AAC/B,QAAI,CAAC,KAAK,EAAE,CAAA;GACb;;;AAGD,QAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,SAAS,EAAE,KAAK,EAC7C,EAAE,GAAG,EAAG,aAAU,EAAE,EAAE;AAClB,UAAI,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,QAAQ,CAAA,AAAC,IAAI,EAAE,IAAI,CAAC,EAAG,EAAE,GAAG,QAAQ,CAAA;AAC/D,UAAI,CAAC,IAAI,GAAG,EAAE,CAAA;AACd,UAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;KACzC;AACD,OAAG,EAAG,eAAY;AAAE,aAAO,IAAI,CAAC,IAAI,CAAA;KAAE;AACtC,cAAU,EAAG,IAAI;GAClB,CAAC,CAAA;;;AAGJ,QAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,SAAS,EAAE,kBAAkB,EAC1D,EAAE,GAAG,EAAG,aAAU,EAAE,EAAE;AAClB,UAAI,OAAO,EAAE,KAAK,UAAU,EAAE;AAC5B,YAAI,CAAC,iBAAiB,GAAG,WAAW,CAAA;AACpC,YAAI,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAA;AAC9B,aAAK,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;AAC3B,cAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,CAAA;SAC5B;OACF,MAAM;AACL,YAAI,CAAC,iBAAiB,GAAG,EAAE,CAAA;AAC3B,YAAI,CAAC,OAAO,GAAG,CAAC,CAAA;AAChB,aAAK,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;AAC3B,cAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAA;AACxE,cAAI,CAAC,OAAO,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,CAAA;SACxC;OACF;;AAED,UAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;KACzC;AACD,OAAG,EAAG,eAAY;AAAE,aAAO,IAAI,CAAC,iBAAiB,CAAA;KAAE;AACnD,cAAU,EAAG,IAAI;GAClB,CAAC,CAAA;;AAEJ,QAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,SAAS,EAAE,QAAQ,EAChD,EAAE,GAAG,EAAG,eAAY;AAAE,aAAO,IAAI,CAAC,OAAO,CAAA;KAAE;AACzC,cAAU,EAAG,IAAI;GAClB,CAAC,CAAA;;AAGJ,QAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,SAAS,EAAE,WAAW,EACnD,EAAE,GAAG,EAAG,eAAY;AAAE,aAAO,IAAI,CAAC,UAAU,CAAA;KAAE;AAC5C,cAAU,EAAG,IAAI;GAClB,CAAC,CAAA;;AAEJ,UAAQ,CAAC,SAAS,CAAC,OAAO,GAAG,UAAU,EAAE,EAAE,KAAK,EAAE;AAChD,SAAK,GAAG,KAAK,IAAI,IAAI,CAAA;AACrB,QAAI,CAAC,GAAG,CAAC,CAAA;AACT,QAAI,SAAS,GAAG,IAAI,CAAC,UAAU,CAAA;;AAE/B,SAAK,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,SAAS,EAAE,CAAC,EAAE,EAAE,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;AAC9E,OAAC,EAAE,CAAA;AACH,UAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;AAC1B,UAAI,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE;AACtB,WAAG,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AACd,YAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,GAAG,SAAS,CAAA;OACvC;AACD,UAAI,GAAG,EAAE;AACP,UAAE,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAA;OACzC;KACF;GACF,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,IAAI,GAAG,YAAY;AACpC,QAAI,IAAI,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;AACrC,QAAI,CAAC,GAAG,CAAC,CAAA;AACT,SAAK,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC,EAAE,EAAE,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;AACpF,UAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;AAC1B,UAAI,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,GAAG,CAAA;KACpB;AACD,WAAO,IAAI,CAAA;GACZ,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,MAAM,GAAG,YAAY;AACtC,QAAI,MAAM,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;AACvC,QAAI,CAAC,GAAG,CAAC,CAAA;AACT,SAAK,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC,EAAE,EAAE,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;AACpF,UAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;AAC1B,YAAM,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,KAAK,CAAA;KACxB;AACD,WAAO,MAAM,CAAA;GACd,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;AACrC,QAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE;AAChC,WAAK,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE;AACzB,YAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAA;OACvC;KACF;;AAED,QAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;AACjC,QAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;AACnC,QAAI,CAAC,IAAI,GAAG,CAAC,CAAA;AACb,QAAI,CAAC,IAAI,GAAG,CAAC,CAAA;AACb,QAAI,CAAC,OAAO,GAAG,CAAC,CAAA;AAChB,QAAI,CAAC,UAAU,GAAG,CAAC,CAAA;GACpB,CAAA;;;;AAID,UAAQ,CAAC,SAAS,CAAC,IAAI,GAAG,YAAY;AACpC,WAAO,IAAI,CAAC,MAAM,CAAA;GACnB,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,OAAO,GAAG,YAAY;AACvC,WAAO,IAAI,CAAC,QAAQ,CAAA;GACrB,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE;AACrD,UAAM,GAAG,MAAM,IAAI,IAAI,CAAC,OAAO,CAAA;AAC/B,QAAI,GAAG,GAAG,MAAM,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAA;;AAEjC,QAAI,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;;AAEzB,UAAI,IAAI,CAAC,QAAQ,EACf,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAA;;AAE5C,UAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,CAAA;AAC1B,UAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,MAAM,CAAA;AAChC,UAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,KAAK,CAAA;AAC9B,UAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;AACb,aAAO,IAAI,CAAA;KACZ;;AAED,QAAI,GAAG,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAA;AACvC,QAAI,GAAG,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,IAAI,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,CAAC,CAAA;;;AAG9D,QAAI,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,EAAE;AAC1B,UAAI,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,KAAK,CAAC,CAAA;AAC5C,aAAO,KAAK,CAAA;KACb;;AAED,QAAI,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,CAAA;AAC1B,QAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,GAAG,CAAA;AAC9C,QAAI,CAAC,UAAU,EAAG,CAAA;;AAElB,QAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,EAC1B,IAAI,CAAC,IAAI,CAAC,CAAA;;AAEZ,WAAO,IAAI,CAAA;GACZ,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,GAAG,EAAE;AACtC,QAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,OAAO,KAAK,CAAA;AACxC,QAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;AAC1B,QAAI,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE;AACtB,aAAO,KAAK,CAAA;KACb;AACD,WAAO,IAAI,CAAA;GACZ,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,GAAG,EAAE;AACtC,WAAO,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,CAAA;GAC5B,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,IAAI,GAAG,UAAU,GAAG,EAAE;AACvC,WAAO,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,CAAA;GAC7B,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,YAAY;AACnC,QAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;AAClC,OAAG,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AACd,WAAO,GAAG,IAAI,IAAI,CAAA;GACnB,CAAA;;AAED,UAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,GAAG,EAAE;AACtC,OAAG,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAA;GAC5B,CAAA;;AAED,WAAS,GAAG,CAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE;AAC9B,QAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;AAC1B,QAAI,GAAG,EAAE;AACP,UAAI,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE;AACtB,WAAG,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AACd,YAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,GAAG,SAAS,CAAA;OACvC,MAAM;AACL,YAAI,KAAK,EAAE,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;OAC1B;AACD,UAAI,GAAG,EAAE,GAAG,GAAG,GAAG,CAAC,KAAK,CAAA;KACzB;AACD,WAAO,GAAG,CAAA;GACX;;AAED,WAAS,OAAO,CAAC,IAAI,EAAE,GAAG,EAAE;AAC1B,QAAI,CAAC,GAAG,IAAK,CAAC,GAAG,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,AAAC,EAAE,OAAO,KAAK,CAAA;AACxD,QAAI,KAAK,GAAG,KAAK,CAAC;AAClB,QAAI,IAAI,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,GAAG,CAAC,GAAG,CAAA;AAC/B,QAAI,GAAG,CAAC,MAAM,EAAE;AACd,WAAK,GAAG,IAAI,GAAG,GAAG,CAAC,MAAM,CAAA;KAC1B,MAAM;AACL,WAAK,GAAG,IAAI,CAAC,OAAO,IAAK,IAAI,GAAG,IAAI,CAAC,OAAO,AAAC,CAAA;KAC9C;AACD,WAAO,KAAK,CAAC;GACd;;AAED,WAAS,GAAG,CAAE,IAAI,EAAE,GAAG,EAAE;AACvB,WAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AAClB,OAAG,CAAC,EAAE,GAAG,IAAI,CAAC,IAAI,EAAG,CAAA;AACrB,QAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAA;GAC5B;;AAED,WAAS,IAAI,CAAE,IAAI,EAAE;AACnB,WAAO,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,EACtD,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;GACtC;;AAED,WAAS,OAAO,CAAE,IAAI,EAAE,GAAG,EAAE;AAC3B,WAAO,IAAI,CAAC,QAAQ,CAAE,GAAG,CAAC,EAAE,CAAE,CAAA;AAC9B,WAAO,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,EAAG,CAAA;GACxE;;AAED,WAAS,GAAG,CAAE,IAAI,EAAE,GAAG,EAAE;AACvB,QAAI,GAAG,EAAE;AACP,UAAI,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC,CAAA;AACpD,UAAI,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,CAAA;AAC1B,UAAI,CAAC,UAAU,EAAG,CAAA;AAClB,aAAO,IAAI,CAAC,MAAM,CAAE,GAAG,CAAC,GAAG,CAAE,CAAA;AAC7B,aAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;KACnB;GACF;;;AAGD,WAAS,KAAK,CAAE,GAAG,EAAE,KAAK,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE;AACnD,QAAI,CAAC,GAAG,GAAG,GAAG,CAAA;AACd,QAAI,CAAC,KAAK,GAAG,KAAK,CAAA;AAClB,QAAI,CAAC,EAAE,GAAG,EAAE,CAAA;AACZ,QAAI,CAAC,MAAM,GAAG,MAAM,CAAA;AACpB,QAAI,CAAC,GAAG,GAAG,GAAG,CAAA;AACd,QAAI,MAAM,EAAE,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;GACjC;CAEA,CAAA,EAAG,CAAA","file":"lru-cache-compiled.js","sourcesContent":[";(function () { // closure for web browsers\n\nif (typeof module === 'object' && module.exports) {\n  module.exports = LRUCache\n} else {\n  // just set the global for non-node platforms.\n  this.LRUCache = LRUCache\n}\n\nfunction hOP (obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key)\n}\n\nfunction naiveLength () { return 1 }\n\nfunction LRUCache (options) {\n  if (!(this instanceof LRUCache))\n    return new LRUCache(options)\n\n  if (typeof options === 'number')\n    options = { max: options }\n\n  if (!options)\n    options = {}\n\n  this._max = options.max\n  // Kind of weird to have a default max of Infinity, but oh well.\n  if (!this._max || !(typeof this._max === \"number\") || this._max <= 0 )\n    this._max = Infinity\n\n  this._lengthCalculator = options.length || naiveLength\n  if (typeof this._lengthCalculator !== \"function\")\n    this._lengthCalculator = naiveLength\n\n  this._allowStale = options.stale || false\n  this._maxAge = options.maxAge || null\n  this._dispose = options.dispose\n  this.reset()\n}\n\n// resize the cache when the max changes.\nObject.defineProperty(LRUCache.prototype, \"max\",\n  { set : function (mL) {\n      if (!mL || !(typeof mL === \"number\") || mL <= 0 ) mL = Infinity\n      this._max = mL\n      if (this._length > this._max) trim(this)\n    }\n  , get : function () { return this._max }\n  , enumerable : true\n  })\n\n// resize the cache when the lengthCalculator changes.\nObject.defineProperty(LRUCache.prototype, \"lengthCalculator\",\n  { set : function (lC) {\n      if (typeof lC !== \"function\") {\n        this._lengthCalculator = naiveLength\n        this._length = this._itemCount\n        for (var key in this._cache) {\n          this._cache[key].length = 1\n        }\n      } else {\n        this._lengthCalculator = lC\n        this._length = 0\n        for (var key in this._cache) {\n          this._cache[key].length = this._lengthCalculator(this._cache[key].value)\n          this._length += this._cache[key].length\n        }\n      }\n\n      if (this._length > this._max) trim(this)\n    }\n  , get : function () { return this._lengthCalculator }\n  , enumerable : true\n  })\n\nObject.defineProperty(LRUCache.prototype, \"length\",\n  { get : function () { return this._length }\n  , enumerable : true\n  })\n\n\nObject.defineProperty(LRUCache.prototype, \"itemCount\",\n  { get : function () { return this._itemCount }\n  , enumerable : true\n  })\n\nLRUCache.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  var i = 0\n  var itemCount = this._itemCount\n\n  for (var k = this._mru - 1; k >= 0 && i < itemCount; k--) if (this._lruList[k]) {\n    i++\n    var hit = this._lruList[k]\n    if (isStale(this, hit)) {\n      del(this, hit)\n      if (!this._allowStale) hit = undefined\n    }\n    if (hit) {\n      fn.call(thisp, hit.value, hit.key, this)\n    }\n  }\n}\n\nLRUCache.prototype.keys = function () {\n  var keys = new Array(this._itemCount)\n  var i = 0\n  for (var k = this._mru - 1; k >= 0 && i < this._itemCount; k--) if (this._lruList[k]) {\n    var hit = this._lruList[k]\n    keys[i++] = hit.key\n  }\n  return keys\n}\n\nLRUCache.prototype.values = function () {\n  var values = new Array(this._itemCount)\n  var i = 0\n  for (var k = this._mru - 1; k >= 0 && i < this._itemCount; k--) if (this._lruList[k]) {\n    var hit = this._lruList[k]\n    values[i++] = hit.value\n  }\n  return values\n}\n\nLRUCache.prototype.reset = function () {\n  if (this._dispose && this._cache) {\n    for (var k in this._cache) {\n      this._dispose(k, this._cache[k].value)\n    }\n  }\n\n  this._cache = Object.create(null) // hash of items by key\n  this._lruList = Object.create(null) // list of items in order of use recency\n  this._mru = 0 // most recently used\n  this._lru = 0 // least recently used\n  this._length = 0 // number of items in the list\n  this._itemCount = 0\n}\n\n// Provided for debugging/dev purposes only. No promises whatsoever that\n// this API stays stable.\nLRUCache.prototype.dump = function () {\n  return this._cache\n}\n\nLRUCache.prototype.dumpLru = function () {\n  return this._lruList\n}\n\nLRUCache.prototype.set = function (key, value, maxAge) {\n  maxAge = maxAge || this._maxAge\n  var now = maxAge ? Date.now() : 0\n\n  if (hOP(this._cache, key)) {\n    // dispose of the old one before overwriting\n    if (this._dispose)\n      this._dispose(key, this._cache[key].value)\n\n    this._cache[key].now = now\n    this._cache[key].maxAge = maxAge\n    this._cache[key].value = value\n    this.get(key)\n    return true\n  }\n\n  var len = this._lengthCalculator(value)\n  var hit = new Entry(key, value, this._mru++, len, now, maxAge)\n\n  // oversized objects fall out of cache automatically.\n  if (hit.length > this._max) {\n    if (this._dispose) this._dispose(key, value)\n    return false\n  }\n\n  this._length += hit.length\n  this._lruList[hit.lu] = this._cache[key] = hit\n  this._itemCount ++\n\n  if (this._length > this._max)\n    trim(this)\n\n  return true\n}\n\nLRUCache.prototype.has = function (key) {\n  if (!hOP(this._cache, key)) return false\n  var hit = this._cache[key]\n  if (isStale(this, hit)) {\n    return false\n  }\n  return true\n}\n\nLRUCache.prototype.get = function (key) {\n  return get(this, key, true)\n}\n\nLRUCache.prototype.peek = function (key) {\n  return get(this, key, false)\n}\n\nLRUCache.prototype.pop = function () {\n  var hit = this._lruList[this._lru]\n  del(this, hit)\n  return hit || null\n}\n\nLRUCache.prototype.del = function (key) {\n  del(this, this._cache[key])\n}\n\nfunction get (self, key, doUse) {\n  var hit = self._cache[key]\n  if (hit) {\n    if (isStale(self, hit)) {\n      del(self, hit)\n      if (!self._allowStale) hit = undefined\n    } else {\n      if (doUse) use(self, hit)\n    }\n    if (hit) hit = hit.value\n  }\n  return hit\n}\n\nfunction isStale(self, hit) {\n  if (!hit || (!hit.maxAge && !self._maxAge)) return false\n  var stale = false;\n  var diff = Date.now() - hit.now\n  if (hit.maxAge) {\n    stale = diff > hit.maxAge\n  } else {\n    stale = self._maxAge && (diff > self._maxAge)\n  }\n  return stale;\n}\n\nfunction use (self, hit) {\n  shiftLU(self, hit)\n  hit.lu = self._mru ++\n  self._lruList[hit.lu] = hit\n}\n\nfunction trim (self) {\n  while (self._lru < self._mru && self._length > self._max)\n    del(self, self._lruList[self._lru])\n}\n\nfunction shiftLU (self, hit) {\n  delete self._lruList[ hit.lu ]\n  while (self._lru < self._mru && !self._lruList[self._lru]) self._lru ++\n}\n\nfunction del (self, hit) {\n  if (hit) {\n    if (self._dispose) self._dispose(hit.key, hit.value)\n    self._length -= hit.length\n    self._itemCount --\n    delete self._cache[ hit.key ]\n    shiftLU(self, hit)\n  }\n}\n\n// classy, since V8 prefers predictable objects.\nfunction Entry (key, value, lu, length, now, maxAge) {\n  this.key = key\n  this.value = value\n  this.lu = lu\n  this.length = length\n  this.now = now\n  if (maxAge) this.maxAge = maxAge\n}\n\n})()\n"]}