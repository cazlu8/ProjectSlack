{"version":3,"sources":["rebuild-compiled.js"],"names":[],"mappings":"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","file":"rebuild-compiled-compiled.js","sourcesContent":["\"use strict\";\n\nmodule.exports = rebuild;\n\nvar readInstalled = require(\"read-installed\"),\n    semver = require(\"semver\"),\n    log = require(\"npmlog\"),\n    npm = require(\"./npm.js\"),\n    npa = require(\"npm-package-arg\");\n\nrebuild.usage = \"npm rebuild [<name>[@<version>] [name[@<version>] ...]]\";\n\nrebuild.completion = require(\"./utils/completion/installed-deep.js\");\n\nfunction rebuild(args, cb) {\n  var opt = { depth: npm.config.get(\"depth\"), dev: true };\n  readInstalled(npm.prefix, opt, function (er, data) {\n    log.info(\"readInstalled\", typeof data);\n    if (er) return cb(er);\n    var set = filter(data, args),\n        folders = Object.keys(set).filter(function (f) {\n      return f !== npm.prefix;\n    });\n    if (!folders.length) return cb();\n    log.silly(\"rebuild set\", folders);\n    cleanBuild(folders, set, cb);\n  });\n}\n\nfunction cleanBuild(folders, set, cb) {\n  npm.commands.build(folders, function (er) {\n    if (er) return cb(er);\n    console.log(folders.map(function (f) {\n      return set[f] + \" \" + f;\n    }).join(\"\\n\"));\n    cb();\n  });\n}\n\nfunction filter(data, args, set, seen) {\n  if (!set) set = {};\n  if (!seen) seen = {};\n  if (set.hasOwnProperty(data.path)) return set;\n  if (seen.hasOwnProperty(data.path)) return set;\n  seen[data.path] = true;\n  var pass;\n  if (!args.length) pass = true // rebuild everything\n  ;else if (data.name && data._id) {\n    for (var i = 0, l = args.length; i < l; i++) {\n      var arg = args[i],\n          nv = npa(arg),\n          n = nv.name,\n          v = nv.rawSpec;\n      if (n !== data.name) continue;\n      if (!semver.satisfies(data.version, v, true)) continue;\n      pass = true;\n      break;\n    }\n  }\n  if (pass && data._id) {\n    log.verbose(\"rebuild\", \"path, id\", [data.path, data._id]);\n    set[data.path] = data._id;\n  }\n  // need to also dive through kids, always.\n  // since this isn't an install these won't get auto-built unless\n  // they're not dependencies.\n  Object.keys(data.dependencies || {}).forEach(function (d) {\n    // return\n    var dep = data.dependencies[d];\n    if (typeof dep === \"string\") return;\n    filter(dep, args, set, seen);\n  });\n  return set;\n}\n\n//# sourceMappingURL=rebuild-compiled.js.map"]}