{"version":3,"sources":["repo.js"],"names":[],"mappings":"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","file":"repo-compiled.js","sourcesContent":["\nmodule.exports = repo\n\nrepo.usage = \"npm repo <pkgname>\"\n\nvar npm = require(\"./npm.js\")\n  , opener = require(\"opener\")\n  , github = require(\"github-url-from-git\")\n  , githubUserRepo = require(\"github-url-from-username-repo\")\n  , path = require(\"path\")\n  , readJson = require(\"read-package-json\")\n  , fs = require(\"fs\")\n  , url_ = require(\"url\")\n  , mapToRegistry = require(\"./utils/map-to-registry.js\")\n  , npa = require(\"npm-package-arg\")\n\nrepo.completion = function (opts, cb) {\n  // FIXME: there used to be registry completion here, but it stopped making\n  // sense somewhere around 50,000 packages on the registry\n  cb()\n}\n\nfunction repo (args, cb) {\n  var n = args.length && npa(args[0]).name || \".\"\n  fs.stat(n, function (er, s) {\n    if (er && er.code === \"ENOENT\") return callRegistry(n, cb)\n    else if (er) return cb(er)\n    if (!s.isDirectory()) return callRegistry(n, cb)\n    readJson(path.resolve(n, \"package.json\"), function (er, d) {\n      if (er) return cb(er)\n      getUrlAndOpen(d, cb)\n    })\n  })\n}\n\nfunction getUrlAndOpen (d, cb) {\n  var r = d.repository\n  if (!r) return cb(new Error(\"no repository\"))\n  // XXX remove this when npm@v1.3.10 from node 0.10 is deprecated\n  // from https://github.com/npm/npm-www/issues/418\n  if (githubUserRepo(r.url))\n    r.url = githubUserRepo(r.url)\n\n  var url = (r.url && ~r.url.indexOf(\"github\"))\n          ? github(r.url)\n          : nonGithubUrl(r.url)\n\n  if (!url)\n    return cb(new Error(\"no repository: could not get url\"))\n  opener(url, { command: npm.config.get(\"browser\") }, cb)\n}\n\nfunction callRegistry (n, cb) {\n  mapToRegistry(n, npm.config, function (er, uri) {\n    if (er) return cb(er)\n\n    npm.registry.get(uri + \"/latest\", { timeout : 3600 }, function (er, d) {\n      if (er) return cb(er)\n      getUrlAndOpen(d, cb)\n    })\n  })\n}\n\nfunction nonGithubUrl (url) {\n  try {\n    var idx = url.indexOf(\"@\")\n    if (idx !== -1) {\n      url = url.slice(idx+1).replace(/:([^\\d]+)/, \"/$1\")\n    }\n    url = url_.parse(url)\n    var protocol = url.protocol === \"https:\"\n                 ? \"https:\"\n                 : \"http:\"\n    return protocol + \"//\" + (url.host || \"\") +\n      url.path.replace(/\\.git$/, \"\")\n  }\n  catch(e) {}\n}\n"]}