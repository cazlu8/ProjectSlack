{"version":3,"sources":["installed-shallow.js"],"names":[],"mappings":"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","file":"installed-shallow-compiled.js","sourcesContent":["\nmodule.exports = installedShallow\n\nvar npm = require(\"../../npm.js\")\n  , fs = require(\"graceful-fs\")\n  , path = require(\"path\")\n  , readJson = require(\"read-package-json\")\n  , asyncMap = require(\"slide\").asyncMap\n\nfunction installedShallow (opts, filter, cb) {\n  if (typeof cb !== \"function\") cb = filter, filter = null\n  var conf = opts.conf\n    , args = conf.argv.remain\n  if (args.length > 3) return cb()\n  var local\n    , global\n    , localDir = npm.dir\n    , globalDir = npm.globalDir\n  if (npm.config.get(\"global\")) local = [], next()\n  else fs.readdir(localDir, function (er, pkgs) {\n    local = (pkgs || []).filter(function (p) {\n      return p.charAt(0) !== \".\"\n    })\n    next()\n  })\n  fs.readdir(globalDir, function (er, pkgs) {\n    global = (pkgs || []).filter(function (p) {\n      return p.charAt(0) !== \".\"\n    })\n    next()\n  })\n  function next () {\n    if (!local || !global) return\n    filterInstalled(local, global, filter, cb)\n  }\n}\n\nfunction filterInstalled (local, global, filter, cb) {\n  var fl\n    , fg\n\n  if (!filter) {\n    fl = local\n    fg = global\n    return next()\n  }\n\n  asyncMap(local, function (p, cb) {\n    readJson(path.join(npm.dir, p, \"package.json\"), function (er, d) {\n      if (!d || !filter(d)) return cb(null, [])\n      return cb(null, d.name)\n    })\n  }, function (er, local) {\n    fl = local || []\n    next()\n  })\n\n  var globalDir = npm.globalDir\n  asyncMap(global, function (p, cb) {\n    readJson(path.join(globalDir, p, \"package.json\"), function (er, d) {\n      if (!d || !filter(d)) return cb(null, [])\n      return cb(null, d.name)\n    })\n  }, function (er, global) {\n    fg = global || []\n    next()\n  })\n\n  function next () {\n    if (!fg || !fl) return\n    if (!npm.config.get(\"global\")) {\n      fg = fg.map(function (g) {\n        return [g, \"-g\"]\n      })\n    }\n    console.error(\"filtered\", fl, fg)\n    return cb(null, fl.concat(fg))\n  }\n}\n"]}