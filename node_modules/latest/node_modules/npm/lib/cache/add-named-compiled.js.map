{"version":3,"sources":["add-named.js"],"names":[],"mappings":"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","file":"add-named-compiled.js","sourcesContent":["var path = require(\"path\")\n  , assert = require(\"assert\")\n  , fs = require(\"graceful-fs\")\n  , http = require(\"http\")\n  , log = require(\"npmlog\")\n  , semver = require(\"semver\")\n  , readJson = require(\"read-package-json\")\n  , url = require(\"url\")\n  , npm = require(\"../npm.js\")\n  , deprCheck = require(\"../utils/depr-check.js\")\n  , inflight = require(\"inflight\")\n  , addRemoteTarball = require(\"./add-remote-tarball.js\")\n  , cachedPackageRoot = require(\"./cached-package-root.js\")\n  , mapToRegistry = require(\"../utils/map-to-registry.js\")\n\n\nmodule.exports = addNamed\n\nfunction getOnceFromRegistry (name, from, next, done) {\n  function fixName(err, data, json, resp) {\n    // this is only necessary until npm/npm-registry-client#80 is fixed\n    if (err && err.pkgid && err.pkgid !== name) {\n      err.message = err.message.replace(\n        new RegExp(': ' + err.pkgid.replace(/(\\W)/g, '\\\\$1') + '$'),\n        ': ' + name\n      )\n      err.pkgid = name\n    }\n    next(err, data, json, resp)\n  }\n\n  mapToRegistry(name, npm.config, function (er, uri, auth) {\n    if (er) return done(er)\n\n    var key = \"registry:\" + uri\n    next = inflight(key, next)\n    if (!next) return log.verbose(from, key, \"already in flight; waiting\")\n    else log.verbose(from, key, \"not in flight; fetching\")\n\n    npm.registry.get(uri, { auth : auth }, fixName)\n  })\n}\n\nfunction addNamed (name, version, data, cb_) {\n  assert(typeof name === \"string\", \"must have module name\")\n  assert(typeof cb_ === \"function\", \"must have callback\")\n\n  var key = name + \"@\" + version\n  log.silly(\"addNamed\", key)\n\n  function cb (er, data) {\n    if (data && !data._fromGithub) data._from = key\n    cb_(er, data)\n  }\n\n  if (semver.valid(version, true)) {\n    log.verbose('addNamed', JSON.stringify(version), 'is a plain semver version for', name)\n    addNameVersion(name, version, data, cb)\n  } else if (semver.validRange(version, true)) {\n    log.verbose('addNamed', JSON.stringify(version), 'is a valid semver range for', name)\n    addNameRange(name, version, data, cb)\n  } else {\n    log.verbose('addNamed', JSON.stringify(version), 'is being treated as a dist-tag for', name)\n    addNameTag(name, version, data, cb)\n  }\n}\n\nfunction addNameTag (name, tag, data, cb) {\n  log.info(\"addNameTag\", [name, tag])\n  var explicit = true\n  if (!tag) {\n    explicit = false\n    tag = npm.config.get(\"tag\")\n  }\n\n  getOnceFromRegistry(name, \"addNameTag\", next, cb)\n\n  function next (er, data, json, resp) {\n    if (!er) er = errorResponse(name, resp)\n    if (er) return cb(er)\n\n    log.silly(\"addNameTag\", \"next cb for\", name, \"with tag\", tag)\n\n    engineFilter(data)\n    if (data[\"dist-tags\"] && data[\"dist-tags\"][tag]\n        && data.versions[data[\"dist-tags\"][tag]]) {\n      var ver = data[\"dist-tags\"][tag]\n      return addNamed(name, ver, data.versions[ver], cb)\n    }\n    if (!explicit && Object.keys(data.versions).length) {\n      return addNamed(name, \"*\", data, cb)\n    }\n\n    er = installTargetsError(tag, data)\n    return cb(er)\n  }\n}\n\nfunction engineFilter (data) {\n  var npmv = npm.version\n    , nodev = npm.config.get(\"node-version\")\n    , strict = npm.config.get(\"engine-strict\")\n\n  if (!nodev || npm.config.get(\"force\")) return data\n\n  Object.keys(data.versions || {}).forEach(function (v) {\n    var eng = data.versions[v].engines\n    if (!eng) return\n    if (!strict && !data.versions[v].engineStrict) return\n    if (eng.node && !semver.satisfies(nodev, eng.node, true)\n        || eng.npm && !semver.satisfies(npmv, eng.npm, true)) {\n      delete data.versions[v]\n    }\n  })\n}\n\nfunction addNameVersion (name, v, data, cb) {\n  var ver = semver.valid(v, true)\n  if (!ver) return cb(new Error(\"Invalid version: \"+v))\n\n  var response\n\n  if (data) {\n    response = null\n    return next()\n  }\n\n  getOnceFromRegistry(name, \"addNameVersion\", setData, cb)\n\n  function setData (er, d, json, resp) {\n    if (!er) {\n      er = errorResponse(name, resp)\n    }\n    if (er) return cb(er)\n    data = d && d.versions[ver]\n    if (!data) {\n      er = new Error(\"version not found: \"+name+\"@\"+ver)\n      er.package = name\n      er.statusCode = 404\n      return cb(er)\n    }\n    response = resp\n    next()\n  }\n\n  function next () {\n    deprCheck(data)\n    var dist = data.dist\n\n    if (!dist) return cb(new Error(\"No dist in \"+data._id+\" package\"))\n\n    if (!dist.tarball) return cb(new Error(\n      \"No dist.tarball in \" + data._id + \" package\"))\n\n    if ((response && response.statusCode !== 304) || npm.config.get(\"force\")) {\n      return fetchit()\n    }\n\n    // we got cached data, so let's see if we have a tarball.\n    var pkgroot = cachedPackageRoot({name : name, version : ver})\n    var pkgtgz = path.join(pkgroot, \"package.tgz\")\n    var pkgjson = path.join(pkgroot, \"package\", \"package.json\")\n    fs.stat(pkgtgz, function (er) {\n      if (!er) {\n        readJson(pkgjson, function (er, data) {\n          if (er && er.code !== \"ENOENT\" && er.code !== \"ENOTDIR\") return cb(er)\n\n          if (data) {\n            if (!data.name) return cb(new Error(\"No name provided\"))\n            if (!data.version) return cb(new Error(\"No version provided\"))\n\n            // check the SHA of the package we have, to ensure it wasn't installed\n            // from somewhere other than the registry (eg, a fork)\n            if (data._shasum && dist.shasum && data._shasum !== dist.shasum) {\n              return fetchit()\n            }\n          }\n\n          if (er) return fetchit()\n            else return cb(null, data)\n        })\n      } else return fetchit()\n    })\n\n    function fetchit () {\n      mapToRegistry(name, npm.config, function (er, _, auth, ruri) {\n        if (er) return cb(er)\n\n        // Use the same protocol as the registry.  https registry --> https\n        // tarballs, but only if they're the same hostname, or else detached\n        // tarballs may not work.\n        var tb = url.parse(dist.tarball)\n        var rp = url.parse(ruri)\n        if (tb.hostname === rp.hostname && tb.protocol !== rp.protocol) {\n          tb.protocol = rp.protocol\n          delete tb.href\n        }\n        tb = url.format(tb)\n\n        // Only add non-shasum'ed packages if --forced. Only ancient things\n        // would lack this for good reasons nowadays.\n        if (!dist.shasum && !npm.config.get(\"force\")) {\n          return cb(new Error(\"package lacks shasum: \" + data._id))\n        }\n\n        addRemoteTarball(tb, data, dist.shasum, auth, cb)\n      })\n    }\n  }\n}\n\nfunction addNameRange (name, range, data, cb) {\n  range = semver.validRange(range, true)\n  if (range === null) return cb(new Error(\n    \"Invalid version range: \" + range\n  ))\n\n  log.silly(\"addNameRange\", {name:name, range:range, hasData:!!data})\n\n  if (data) return next()\n\n  getOnceFromRegistry(name, \"addNameRange\", setData, cb)\n\n  function setData (er, d, json, resp) {\n    if (!er) {\n      er = errorResponse(name, resp)\n    }\n    if (er) return cb(er)\n    data = d\n    next()\n  }\n\n  function next () {\n    log.silly( \"addNameRange\", \"number 2\"\n             , {name:name, range:range, hasData:!!data})\n    engineFilter(data)\n\n    log.silly(\"addNameRange\", \"versions\"\n             , [data.name, Object.keys(data.versions || {})])\n\n    // if the tagged version satisfies, then use that.\n    var tagged = data[\"dist-tags\"][npm.config.get(\"tag\")]\n    if (tagged\n        && data.versions[tagged]\n        && semver.satisfies(tagged, range, true)) {\n      return addNamed(name, tagged, data.versions[tagged], cb)\n    }\n\n    // find the max satisfying version.\n    var versions = Object.keys(data.versions || {})\n    var ms = semver.maxSatisfying(versions, range, true)\n    if (!ms) {\n      return cb(installTargetsError(range, data))\n    }\n\n    // if we don't have a registry connection, try to see if\n    // there's a cached copy that will be ok.\n    addNamed(name, ms, data.versions[ms], cb)\n  }\n}\n\nfunction installTargetsError (requested, data) {\n  var targets = Object.keys(data[\"dist-tags\"]).filter(function (f) {\n    return (data.versions || {}).hasOwnProperty(f)\n  }).concat(Object.keys(data.versions || {}))\n\n  requested = data.name + (requested ? \"@'\" + requested + \"'\" : \"\")\n\n  targets = targets.length\n          ? \"Valid install targets:\\n\" + JSON.stringify(targets) + \"\\n\"\n          : \"No valid targets found.\\n\"\n          + \"Perhaps not compatible with your version of node?\"\n\n  var er = new Error( \"No compatible version found: \"\n                  + requested + \"\\n\" + targets)\n  er.code = \"ETARGET\"\n  return er\n}\n\nfunction errorResponse (name, response) {\n  var er\n  if (response.statusCode >= 400) {\n    er = new Error(http.STATUS_CODES[response.statusCode])\n    er.statusCode = response.statusCode\n    er.code = \"E\" + er.statusCode\n    er.pkgid = name\n  }\n  return er\n}\n"]}